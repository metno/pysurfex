
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>PYSURFEX documentation &#8212; SURFEX Python API (pysurfex)  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="#">SURFEX Python API (pysurfex)  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">PYSURFEX documentation</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="pysurfex-documentation">
<h1>PYSURFEX documentation<a class="headerlink" href="#pysurfex-documentation" title="Permalink to this heading">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<img alt="https://coveralls.io/repos/github/metno/pysurfex/badge.svg?branch=master" id="readme" src="https://coveralls.io/repos/github/metno/pysurfex/badge.svg?branch=master" />
<p><a class="reference external" href="https://coveralls.io/github/metno/pysurfex">https://coveralls.io/github/metno/pysurfex</a></p>
</section>
<section id="python-api-to-surfex-pysurfex">
<h1>Python API to SURFEX (pysurfex)<a class="headerlink" href="#python-api-to-surfex-pysurfex" title="Permalink to this heading">¶</a></h1>
<dl class="simple">
<dt>An API in python to the external surface model SURFEX.</dt><dd><ul class="simple">
<li><p>Prepare input and namelists to a SURFEX binary</p></li>
<li><p>Create atmospheric forcing for offline SURFEX runs</p></li>
<li><p>Read SURFEX output</p></li>
<li><p>A scheduler setup to run offline SURFEX experiments</p></li>
<li><p>Quality control of observations with titanlib</p></li>
<li><p>Optimal interpolation with gridpp</p></li>
<li><p>Monitor the observations usage</p></li>
</ul>
</dd>
</dl>
<p>See online documentation in <a class="reference external" href="https://metno.github.io/pysurfex/">https://metno.github.io/pysurfex/</a></p>
<section id="installation-of-pregenerated-packages-from-pypi-pip">
<h2>Installation of pregenerated packages from pypi (pip)<a class="headerlink" href="#installation-of-pregenerated-packages-from-pypi-pip" title="Permalink to this heading">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip3<span class="w"> </span>install<span class="w"> </span>pysurfex
</pre></div>
</div>
<p>User installation:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip3<span class="w"> </span>install<span class="w"> </span>pysurfex<span class="w"> </span>--user
</pre></div>
</div>
</section>
<section id="installation-on-debian-based-linux-system">
<h2>Installation on debian based Linux system<a class="headerlink" href="#installation-on-debian-based-linux-system" title="Permalink to this heading">¶</a></h2>
<p>Install the required pacakges (some might be obsolete if the pip packages contain the needed depedencies):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt-get<span class="w"> </span>update
sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>libudunits2-dev<span class="w"> </span>libproj-dev<span class="w"> </span>libeccodes0<span class="w"> </span>libeccodes-dev<span class="w"> </span>libnetcdf-dev<span class="w"> </span>netcdf-bin
</pre></div>
</div>
<p>The following depencies are needed. Install the non-standard ones e.g. with pip or your system installation system.</p>
</section>
<section id="general-dependencies-from-pypi">
<h2>General dependencies (from pypi)<a class="headerlink" href="#general-dependencies-from-pypi" title="Permalink to this heading">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>numpy
netCDF4
cfunits
pyproj
pyyaml
toml
netCDF4
f90nml
requests
</pre></div>
</div>
<p>To read NetCDF files:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>NetCDF4
</pre></div>
</div>
<p>To read grib files:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>eccodes
</pre></div>
</div>
<p>from ECMWF <a class="reference external" href="https://software.ecmwf.int/wiki/display/ECC/Releases">https://software.ecmwf.int/wiki/display/ECC/Releases</a> installed with ENABLE_PYTHON=ON</p>
<p>To plot:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>matplotlib
</pre></div>
</div>
<p>To get observations from frost.met.no API:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>requests
</pre></div>
</div>
<p>For Quality control of observations</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>titanlib
db-sqlite3
</pre></div>
</div>
<p>For optimal interpolation and observation operators</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gridpp
</pre></div>
</div>
<p>For testing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest
</pre></div>
</div>
<p>Download the source code, then install <code class="docutils literal notranslate"><span class="pre">pysurfex</span></code> by executing the following inside the extracted
folder:</p>
</section>
<section id="install-pysurfex">
<h2>Install pysurfex<a class="headerlink" href="#install-pysurfex" title="Permalink to this heading">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>poetry<span class="w"> </span>install
</pre></div>
</div>
</section>
<section id="create-documentation">
<h2>Create documentation<a class="headerlink" href="#create-documentation" title="Permalink to this heading">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>docs
<span class="c1"># Create html documentation</span>
make<span class="w"> </span>html
</pre></div>
</div>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">¶</a></h2>
<p>See <a class="reference external" href="https://metno.github.io/pysurfex/#examples">https://metno.github.io/pysurfex/#examples</a></p>
</section>
</section>
<section id="id1">
<h1>Examples<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h1>
<p>First you must install pysurfex for example with poetry</p>
<p>Create forcing from MET-Nordic analysis</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Local address: /lustre/storeB/project/metproduction/products/yr_short/met_analysis_1_0km_nordic_@YYYY@@MM@@DD@T@HH@Z.nc</span>
<span class="c1"># Thredds: https://thredds.met.no/thredds/dodsC/metpparchivev3/@YYYY@/@MM@/@DD@/met_analysis_1_0km_nordic_@YYYY@@MM@@DD@T@HH@Z.nc</span>

<span class="c1"># Thredds example:</span>
create_forcing<span class="w"> </span>-p<span class="w">  </span>https://thredds.met.no/thredds/dodsC/metpparchivev3/@YYYY@/@MM@/@DD@/met_analysis_1_0km_nordic_@YYYY@@MM@@DD@T@HH@Z.nc<span class="w"> </span><span class="se">\</span>
<span class="w"> </span><span class="m">2023013010</span><span class="w"> </span><span class="m">2023013011</span><span class="w"> </span>-d<span class="w"> </span>domain.json<span class="w"> </span>-a<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>--rain_converter<span class="w"> </span>calcrain<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>--snow_converter<span class="w"> </span>calcsnow<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>--zref<span class="w"> </span>screen<span class="w"> </span>--uref<span class="w"> </span>screen<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>--qa_converter<span class="w"> </span>rh2q_mslp<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>--co2<span class="w"> </span>constant<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>--dir_sw_converter<span class="w"> </span>analysis<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>--sca_sw<span class="w"> </span>constant<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>--lw_converter<span class="w"> </span>analysis<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>--wind_converter<span class="w"> </span>none<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>--wind_dir_converter<span class="w"> </span>none<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>--ps_converter<span class="w"> </span>mslp2ps
</pre></div>
</div>
<p>Example on a Lambert conf proj domain</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;nam_pgd_grid&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;cgrid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CONF PROJ&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;nam_conf_proj&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;xbeta&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;xlat0&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">63.0</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;xlon0&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">15.0</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;xrpk&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.8910065241883678</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;nam_conf_proj_grid&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;nimax&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;njmax&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;xdx&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1000.0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;xdy&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1000.0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;xlatcen&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">61.5</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;xloncen&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">9.0</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Example on a system json file</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;ecoclimap_bin_dir&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/lustre/storeB/users/trygveasp/H2O/open_SURFEX_V8_1/MY_RUN/ECOCLIMAP/&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;climdir&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/lustre/storeB/project/nwp/surfex/PGD/&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;oro_dir&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/lustre/storeB/project/nwp/surfex/PGD/&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="run-open-surfex-8-1">
<h1>Run open-SURFEX 8.1<a class="headerlink" href="#run-open-surfex-8-1" title="Permalink to this heading">¶</a></h1>
<ul class="simple">
<li><p>Assume pysurfex is installed and in your path</p></li>
<li><p>Assume pysurfex installation directory is “path-to-pysurfex”</p></li>
<li><p>Assume that you have your surfex binaries in PATH and that they are called PGD, PREP, OFFLINE and SODA</p></li>
<li><p>Assume that you have system paths defined in a file called system.json</p></li>
<li><p>Assume a domain defined in a file called domain.json</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>tutorial_open_surfex_8_1
<span class="nb">cd</span><span class="w"> </span>tutorial_open_surfex_8_1

<span class="c1"># Copy example settings (Modify if wanted)</span>
cp<span class="w"> </span>path-to-pysurfex/examples/cfg/config_exp_surfex_open_surfex_8_1.toml<span class="w"> </span>config_exp_surfex.toml

<span class="c1"># Copy namelist settings (modify if wanted)</span>
cp<span class="w"> </span>-r<span class="w"> </span>/modules/centos7/user-apps/suv/pysurfex/0.0.1-dev/examples/nam_open_surfex_8_1<span class="w"> </span>nam_open_surfex_8_1

<span class="c1"># Use only one openMP thread</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">OMP_NUM_THREADS</span><span class="o">=</span><span class="m">1</span>

<span class="c1"># Dump environment</span>
dump_environ

<span class="c1"># Create PGD</span>
pgd<span class="w"> </span>-c<span class="w"> </span>config_exp_surfex.toml<span class="w"> </span>-r<span class="w"> </span>rte.json<span class="w"> </span>--domain<span class="w"> </span>domain.json<span class="w"> </span>-s<span class="w"> </span>system.json<span class="w"> </span>-n<span class="w"> </span>nam_open_surfex_8_1<span class="w"> </span>-o<span class="w"> </span>PGD.nc<span class="w"> </span>PGD

<span class="c1"># Create PREP (from namelist values)</span>
prep<span class="w"> </span>-c<span class="w"> </span>config_exp_surfex.toml<span class="w"> </span>-r<span class="w"> </span>rte.json<span class="w"> </span>--domain<span class="w"> </span>domain.json<span class="w"> </span>-s<span class="w"> </span>system.json<span class="w"> </span>-n<span class="w"> </span>nam_open_surfex_8_1<span class="w"> </span>--pgd<span class="w"> </span>PGD.nc<span class="w"> </span>-o<span class="w"> </span>PREP.nc<span class="w"> </span>--prep_file<span class="w"> </span>path-to-pysurfex/test/nam/prep_from_namelist_values.json<span class="w"> </span>--prep_filetype<span class="w"> </span>json<span class="w"> </span>--dtg<span class="w"> </span><span class="m">2021010103</span><span class="w"> </span>PREP

<span class="c1"># Create forcing from 2021010103 to 2021010104 (From MET-Nordic on MET-Norway thredds server)</span>
create_forcing<span class="w"> </span><span class="m">2021010103</span><span class="w"> </span><span class="m">2021010104</span><span class="w"> </span>-d<span class="w"> </span>domain.json<span class="w"> </span>-p<span class="w"> </span>https://thredds.met.no/thredds/dodsC/metusers/trygveasp/forcing/met_nordic/@YYYY@/@MM@/@DD@//FORCING_@YYYY@@MM@@DD@T@HH@Z.nc<span class="w"> </span>--zsoro_converter<span class="w"> </span>none<span class="w"> </span>-i<span class="w"> </span>surfex<span class="w"> </span>--rain_converter<span class="w"> </span>none<span class="w"> </span>--wind_converter<span class="w"> </span>none<span class="w"> </span>--wind_dir_converter<span class="w"> </span>none<span class="w"> </span>-ig<span class="w"> </span>path-to-pysurfex/0.0.1-dev/examples/domains/met_nordic.json

<span class="c1"># Run Offline</span>
offline<span class="w"> </span>-c<span class="w"> </span>config_exp_surfex.toml<span class="w"> </span>-r<span class="w"> </span>rte.json<span class="w"> </span>--domain<span class="w"> </span>domain.json<span class="w"> </span>-s<span class="w"> </span>system.json<span class="w"> </span>-n<span class="w"> </span>nam_open_surfex_8_1<span class="w"> </span>--pgd<span class="w"> </span>PGD.nc<span class="w"> </span>--prep<span class="w"> </span>PREP.nc<span class="w"> </span>-o<span class="w"> </span>SURFOUT.nc<span class="w"> </span>OFFLINE<span class="w"> </span>--forcing<span class="w"> </span><span class="nv">$PWD</span>
</pre></div>
</div>
</section>
<section id="run-open-surfex-8-1-on-centos7-ppi">
<h1>Run open-SURFEX 8.1 on centos7 PPI<a class="headerlink" href="#run-open-surfex-8-1-on-centos7-ppi" title="Permalink to this heading">¶</a></h1>
<ul class="simple">
<li><p>Let us assume that you have your surfex binaries in PATH and that they are called PGD, PREP, OFFLINE and SODA</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load pysurfex</span>
module<span class="w"> </span>load<span class="w"> </span>Python/3.7.3<span class="w"> </span>gridpp/0.6.0<span class="w"> </span>suv/pysurfex/0.0.1-dev

mkdir<span class="w"> </span>tutorial_open_surfex_8_1_ppi
<span class="nb">cd</span><span class="w"> </span>tutorial_open_surfex_8_1_ppi

<span class="c1"># Copy example settings (modify if wanted)</span>
cp<span class="w"> </span>/modules/centos7/user-apps/suv/pysurfex/0.0.1-dev/examples/cfg/config_exp_surfex_open_surfex_8_1.toml<span class="w"> </span>config_exp_surfex.toml

<span class="c1"># Copy namelist settings (modify if wanted)</span>
cp<span class="w"> </span>-r<span class="w"> </span>/modules/centos7/user-apps/suv/pysurfex/0.0.1-dev/examples/nam_open_surfex_8_1<span class="w"> </span>nam_open_surfex_8_1

<span class="c1"># Link ppi settings (to make commands shorter)</span>
ln<span class="w"> </span>-sf<span class="w"> </span>/modules/centos7/user-apps/suv/pysurfex/0.0.1-dev/examples/cfg/ppi_centos7.json<span class="w"> </span>ppi.json

<span class="c1"># Create your domain in a file called domain.json</span>

<span class="c1"># Set openMP threads</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">OMP_NUM_THREADS</span><span class="o">=</span><span class="m">1</span>

<span class="c1"># Dump environment</span>
dump_environ

<span class="c1"># Create PGD (Positional argument PGD is the name of your PGD binary)</span>
pgd<span class="w"> </span>-c<span class="w"> </span>config_exp_surfex.toml<span class="w"> </span>-r<span class="w"> </span>rte.json<span class="w"> </span>--domain<span class="w"> </span>domain.json<span class="w"> </span>-s<span class="w"> </span>ppi.json<span class="w"> </span>-n<span class="w"> </span>nam_open_surfex_8_1<span class="w"> </span>-o<span class="w"> </span>PGD.nc<span class="w"> </span>PGD

<span class="c1"># Create PREP (Positional argument PREP is the name of your PREP binary)</span>
prep<span class="w"> </span>-c<span class="w"> </span>config_exp_surfex.toml<span class="w"> </span>-r<span class="w"> </span>rte.json<span class="w"> </span>--domain<span class="w"> </span>domain.json<span class="w"> </span>-s<span class="w"> </span>ppi.json<span class="w"> </span>-n<span class="w"> </span>nam_open_surfex_8_1<span class="w"> </span>--pgd<span class="w"> </span>PGD.nc<span class="w"> </span>-o<span class="w"> </span>PREP.nc<span class="w"> </span>--prep_file<span class="w"> </span>/modules/centos7/user-apps/suv/pysurfex/0.0.1-dev/test/nam/prep_from_namelist_values.json<span class="w"> </span>--prep_filetype<span class="w"> </span>json<span class="w"> </span>--dtg<span class="w"> </span><span class="m">2021010103</span><span class="w"> </span>PREP

<span class="c1"># Create forcing from 2021010103 to 2021010104 (From MET-Nordic on MET-Norway thredds server)</span>
create_forcing<span class="w"> </span><span class="m">2021010103</span><span class="w"> </span><span class="m">2021010104</span><span class="w"> </span>-d<span class="w"> </span>domain.json<span class="w"> </span>-p<span class="w"> </span>https://thredds.met.no/thredds/dodsC/metusers/trygveasp/forcing/met_nordic/@YYYY@/@MM@/@DD@//FORCING_@YYYY@@MM@@DD@T@HH@Z.nc<span class="w"> </span>--zsoro_converter<span class="w"> </span>none<span class="w"> </span>-i<span class="w"> </span>surfex<span class="w"> </span>--rain_converter<span class="w"> </span>none<span class="w"> </span>--wind_converter<span class="w"> </span>none<span class="w"> </span>--wind_dir_converter<span class="w"> </span>none<span class="w"> </span>-ig<span class="w"> </span>/modules/centos7/user-apps/suv/pysurfex/0.0.1-dev/examples/domains/met_nordic.json

<span class="c1"># Run Offline (Positional argument OFFLINE is the name of your OFFLINE binary)</span>
<span class="c1"># If your domain is different from your forcing you might need to use option --forc_zs</span>
offline<span class="w"> </span>-c<span class="w"> </span>config_exp_surfex.toml<span class="w"> </span>-r<span class="w"> </span>rte.json<span class="w"> </span>--domain<span class="w"> </span>domain.json<span class="w"> </span>-s<span class="w"> </span>ppi.json<span class="w"> </span>-n<span class="w"> </span>nam_open_surfex_8_1<span class="w"> </span>--pgd<span class="w"> </span>PGD.nc<span class="w"> </span>--prep<span class="w"> </span>PREP.nc<span class="w"> </span>-o<span class="w"> </span>SURFOUT.nc<span class="w"> </span>OFFLINE<span class="w"> </span>--forcing<span class="w"> </span><span class="nv">$PWD</span><span class="w"> </span>--forc_zs
</pre></div>
</div>
</section>
<section id="run-surfex-from-the-module-suv-surfex-cy43-dev-on-ppi-cy43-development-version">
<h1>Run surfex from the module suv/surfex/cy43-dev on PPI (cy43 development version)<a class="headerlink" href="#run-surfex-from-the-module-suv-surfex-cy43-dev-on-ppi-cy43-development-version" title="Permalink to this heading">¶</a></h1>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load modules</span>
module<span class="w"> </span>load<span class="w"> </span>suv/surfex/cy43-dev<span class="w"> </span>Python/3.7.3<span class="w"> </span>gridpp/0.6.0<span class="w"> </span>suv/pysurfex/0.0.1-dev

mkdir<span class="w"> </span>tutorial_cy43_dev_ppi
<span class="nb">cd</span><span class="w"> </span>tutorial_cy43_dev_ppi

<span class="c1"># Copy example settings (Modify if wanted)</span>
cp<span class="w"> </span>/modules/centos7/user-apps/suv/pysurfex/0.0.1-dev/examples/cfg/config_exp_surfex_cy43_dev_ppi.toml<span class="w"> </span>config_exp_surfex.toml

<span class="c1"># Link ppi settings (to make commands shorter)</span>
ln<span class="w"> </span>-sf<span class="w"> </span>/modules/centos7/user-apps/suv/pysurfex/0.0.1-dev/examples/cfg/ppi_centos7.json<span class="w"> </span>ppi.json

<span class="c1"># Use namelists from examples</span>
cp<span class="w"> </span>-r<span class="w"> </span>/modules/centos7/user-apps/suv/pysurfex/0.0.1-dev/examples/nam_cy43_dev<span class="w"> </span>nam_cy43_dev_ppi

<span class="c1"># Modify settings (if wanted)</span>

<span class="c1"># Create your domain in a file called domain.json</span>

<span class="c1"># Set openMP threads</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">OMP_NUM_THREADS</span><span class="o">=</span><span class="m">1</span>

<span class="c1"># Dump environment</span>
dump_environ

<span class="c1"># Create PGD</span>
pgd<span class="w"> </span>-c<span class="w"> </span>config_exp_surfex.toml<span class="w"> </span>-r<span class="w"> </span>rte.json<span class="w"> </span>--domain<span class="w"> </span>domain.json<span class="w"> </span>-s<span class="w"> </span>ppi.json<span class="w"> </span>-n<span class="w"> </span>nam_cy43_dev_ppi<span class="w"> </span>-o<span class="w"> </span>PGD.nc<span class="w"> </span>PGD-METNO-centOS-SFX-V8-1-1-OPENMPI-PPI-GFORTRAN-CENTOS-OMP-O2-X0

<span class="c1"># Create PREP</span>
prep<span class="w"> </span>-c<span class="w"> </span>config_exp_surfex.toml<span class="w"> </span>-r<span class="w"> </span>rte.json<span class="w"> </span>--domain<span class="w"> </span>domain.json<span class="w"> </span>-s<span class="w"> </span>ppi.json<span class="w"> </span>-n<span class="w"> </span>nam_cy43_dev_ppi<span class="w"> </span>--pgd<span class="w"> </span>PGD.nc<span class="w"> </span>-o<span class="w"> </span>PREP.nc<span class="w"> </span>--prep_file<span class="w"> </span>/modules/centos7/user-apps/suv/pysurfex/0.0.1-dev/test/nam/prep_from_namelist_values.json<span class="w"> </span>--prep_filetype<span class="w"> </span>json<span class="w">  </span>--dtg<span class="w"> </span><span class="m">2021010103</span><span class="w"> </span>PREP-METNO-centOS-SFX-V8-1-1-OPENMPI-PPI-GFORTRAN-CENTOS-OMP-O2-X0

<span class="c1"># Create forcing from 2021010103 to 2021010104 (From MET-Nordic on MET-Norway thredds server)</span>
create_forcing<span class="w"> </span><span class="m">2021010103</span><span class="w"> </span><span class="m">2021010104</span><span class="w"> </span>-d<span class="w"> </span>domain.json<span class="w"> </span>-p<span class="w"> </span>https://thredds.met.no/thredds/dodsC/metusers/trygveasp/forcing/met_nordic/@YYYY@/@MM@/@DD@//FORCING_@YYYY@@MM@@DD@T@HH@Z.nc<span class="w"> </span>--zsoro_converter<span class="w"> </span>none<span class="w"> </span>-i<span class="w"> </span>surfex<span class="w"> </span>--rain_converter<span class="w"> </span>none<span class="w"> </span>--wind_converter<span class="w"> </span>none<span class="w"> </span>--wind_dir_converter<span class="w"> </span>none<span class="w"> </span>-ig<span class="w"> </span>/modules/centos7/user-apps/suv/pysurfex/0.0.1-dev/examples/domains/met_nordic.json

<span class="c1"># Run Offline</span>
offline<span class="w"> </span>-c<span class="w"> </span>config_exp_surfex.toml<span class="w"> </span>-r<span class="w"> </span>rte.json<span class="w"> </span>--domain<span class="w"> </span>domain.json<span class="w"> </span>-s<span class="w"> </span>ppi.json<span class="w"> </span>-n<span class="w"> </span>nam_cy43_dev_ppi<span class="w"> </span>--pgd<span class="w"> </span>PGD.nc<span class="w"> </span>--prep<span class="w"> </span>PREP.nc<span class="w"> </span>-o<span class="w"> </span>SURFOUT.nc<span class="w"> </span>OFFLINE-METNO-centOS-SFX-V8-1-1-OPENMPI-PPI-GFORTRAN-CENTOS-OMP-O2-X0<span class="w"> </span>--forcing<span class="w"> </span><span class="nv">$PWD</span><span class="w"> </span>--forc_zs
</pre></div>
</div>
</section>
<section id="plot-meps-data-from-thredds">
<h1>Plot MEPS data from thredds<a class="headerlink" href="#plot-meps-data-from-thredds" title="Permalink to this heading">¶</a></h1>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>plot_points<span class="w"> </span>-v<span class="w"> </span>air_temperature_2m<span class="w"> </span>-g<span class="w"> </span>examples/domains/drammen.json<span class="w"> </span>-it<span class="w"> </span>netcdf<span class="w"> </span>-i<span class="w"> </span>https://thredds.met.no/thredds/dodsC/meps25epsarchive/2023/04/13/meps_det_2_5km_20230413T06Z.nc<span class="w"> </span>-t<span class="w"> </span><span class="m">2023041307</span>
</pre></div>
</div>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this heading">¶</a></h2>
</section>
<section id="class-methods">
<h2>Class methods<a class="headerlink" href="#class-methods" title="Permalink to this heading">¶</a></h2>
</section>
<section id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><dl class="field-list simple">
<dt class="field-odd">ref<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>README</cite></p>
</dd>
</dl>
</li>
</ul>
</section>
</section>
<section id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this heading">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="#">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">PYSURFEX documentation</a></li>
<li><a class="reference internal" href="#python-api-to-surfex-pysurfex">Python API to SURFEX (pysurfex)</a><ul>
<li><a class="reference internal" href="#installation-of-pregenerated-packages-from-pypi-pip">Installation of pregenerated packages from pypi (pip)</a></li>
<li><a class="reference internal" href="#installation-on-debian-based-linux-system">Installation on debian based Linux system</a></li>
<li><a class="reference internal" href="#general-dependencies-from-pypi">General dependencies (from pypi)</a></li>
<li><a class="reference internal" href="#install-pysurfex">Install pysurfex</a></li>
<li><a class="reference internal" href="#create-documentation">Create documentation</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id1">Examples</a></li>
<li><a class="reference internal" href="#run-open-surfex-8-1">Run open-SURFEX 8.1</a></li>
<li><a class="reference internal" href="#run-open-surfex-8-1-on-centos7-ppi">Run open-SURFEX 8.1 on centos7 PPI</a></li>
<li><a class="reference internal" href="#run-surfex-from-the-module-suv-surfex-cy43-dev-on-ppi-cy43-development-version">Run surfex from the module suv/surfex/cy43-dev on PPI (cy43 development version)</a></li>
<li><a class="reference internal" href="#plot-meps-data-from-thredds">Plot MEPS data from thredds</a><ul>
<li><a class="reference internal" href="#classes">Classes</a></li>
<li><a class="reference internal" href="#class-methods">Class methods</a></li>
<li><a class="reference internal" href="#methods">Methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>

  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="#">SURFEX Python API (pysurfex)  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">PYSURFEX documentation</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Trygve Aspelien.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.2.1.
    </div>
  </body>
</html>